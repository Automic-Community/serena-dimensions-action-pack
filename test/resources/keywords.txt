*** Settings ***
Documentation     This is high level keywords that will be used by local test cases
Resource          messages.txt
Resource          context.txt
Library           com.automic.robot.itpa.ItpaLibrary

*** Key Words ***
Delete Directory
    [Arguments]    ${directory}
    Init Action    ${ACTION_DELETE}
    Action Set    ${PRT_DELETE_DIR_FILE_RM_NAME}    ${directory}
    Action Set    ${PRT_DELETE_DIR_FILE_RM_FAIL}    NO
    Action Execute

Init Action
    [Arguments]    ${actionName}
    Action Create    ${actionName}
    Action Set    ${PRT_AGENT}    ${_AGENT}
    Action Set    ${PRT_LOGIN}    ${_LOGIN}

Action Report Should Contain
    [Arguments]    ${text}
    ${report} =    Action Get Report
    Should Contain    ${report}    ${text}

Action Report Should Be Found
    ${report} =    Action Get Report
    Should Not Be Empty    ${report}

Action Report Should Not Be Found
    ${report} =    Action Get Report
    Should Be Empty    ${report}

Action Return Code Should Be
    [Arguments]    ${code}
    ${returnCode}=    Action Get Variable    Return code
    Should Be Equal    ${returnCode}    ${code}

Action Return Code Should Not Equal
    [Arguments]    ${code}
    ${returnCode}=    Action Get Variable    Return code
    Should Not Be Equal    ${returnCode}    ${code}

Action Return Status Should Be
    [Arguments]    ${status}
    ${returnStatus}=    Action Get Variable    Status
    Should Be Equal    ${returnStatus}    ${status}

Action Return Status Should Not Be
    [Arguments]    ${status}
    ${returnStatus}=    Action Get Variable    Status
    Should Not Be Equal    ${returnStatus}    ${status}

Action Return Variable Should Be
    [Arguments]    ${variableValue}
    ${out}=    Action Get Variable    ${variableName}
    Should Be Equal    ${out}    ${variableValue}

Action Return Variable Should Be Equal As Integers
    [Arguments]    ${variableValue}
    ${out}=    Action Get Variable    ${variableName}
    Should Be Equal As Integers    ${out}    ${variableValue}

Create Dir
    [Arguments]    ${path}
    Init Action    PCK.AUTOMIC_FILESYSTEM.PUB.ACTION.CREATE_DIR
    Action Set    &UC4RB_DIR_FILE_CREATE_DIR#    ${path}
    Action Execute

Delete Dir
    [Arguments]    ${path}
    Init Action    PCK.AUTOMIC_FILESYSTEM.PUB.ACTION.DELETE
    Action Set    &UC4RB_DIR_FILE_RM_NAME#    ${path}
    Action Set    &UC4RB_DIR_FILE_RM_FAIL#    NO
    Action Execute

Create File
    [Arguments]    ${file_path}
    Init Action    PCK.AUTOMIC_FILESYSTEM.PUB.ACTION.CREATE_FILE
    Action Set    &UC4RB_DIR_FILE_CREATE_FILE#    ${file_path}
    Action Set    &UC4RB_DIR_FILE_FULL_PATH#    YES
    Action Execute

Pack
    [Arguments]    ${source_file_path}    ${target_file_path}
    Init Action    PCK.AUTOMIC_FILESYSTEM.PUB.ACTION.PACK
    Action Set    &UC4RB_DIR_FILE_PACK_INPUT#    ${source_file_path}
    Action Set    &UC4RB_DIR_FILE_PACK_NAME#    ${target_file_path}
    Action Set    &UC4RB_ADD_ZIP#    NO
    Action Execute

Copy
    [Arguments]    ${source_file_path}    ${target_file_path}
    Init Action    PCK.AUTOMIC_FILESYSTEM.PUB.ACTION.COPY
    Action Set    &UC4RB_DIR_FILE_CP_SOURCE#    ${source_file_path}
    Action Set    &UC4RB_DIR_FILE_CP_TARGET#    ${target_file_path}
    Action Set    &UC4RB_DIR_FILE_CP_OVERWRITE#    YES
    Action Set    &UC4RB_COPY_EXCLUDE#    ${EMPTY}
    Action Execute

Checkout Module
    [Arguments]    ${module}    ${revision}    ${target_path}
    Init Action    ${ACTION_CHECKOUT}
    Action Set    ${PRT_CHECKOUT_CVS_URI}    ${_CVS_URI}
    Action Set    ${PRT_CHECKOUT_CVS_MODULE}    ${module}
    Action Set    ${PRT_CHECKOUT_CVS_PASSWORD}    ${_CVS_PASS}
    Action Set    ${PRT_CHECKOUT_CVS_EXPORT_PATH}    ${target_path}
    Action Set    ${PRT_CHECKOUT_CVS_REVISION}    ${revision}
    Action Execute

Export Module
    [Arguments]    ${module}    ${revision}    ${target_path}
    Init Action    ${ACTION_EXPORT}
    Action Set    ${PRT_EXPORT_CVS_URI}    ${_CVS_URI}
    Action Set    ${PRT_EXPORT_CVS_MODULE}    ${module}
    Action Set    ${PRT_EXPORT_CVS_PASSWORD}    ${_CVS_PASS}
    Action Set    ${PRT_EXPORT_CVS_EXPORT_PATH}    ${target_path}
    Action Set    ${PRT_EXPORT_CVS_REVISION}    ${revision}
    Action Execute

Remove Template
    [Arguments]    ${OK_NOK}    ${uri}    ${password}    ${working_copy}    ${target}    ${deleteFile}
    ...    ${recursive}    ${returnCode}    ${returnStatus}
    Init Action    ${ACTION_REMOVE}
    Action Set    ${PRT_REMOVE_CVS_URI}    ${uri}
    Action Set    ${PRT_REMOVE_CVS_WORKING_DIRECTORY}    ${working_copy}
    Action Set    ${PRT_REMOVE_CVS_PASSWORD}    ${password}
    Action Set    ${PRT_REMOVE_CVS_TARGET_PATH}    ${target}
    Action Set    ${PRT_REMOVE_CVS_DELETE_FILE}    ${deleteFile}
    Action Set    ${PRT_REMOVE_CVS_RECURSIVE}    ${recursive}
    Action Execute
    Action Report Should Be Found
    Run Keyword If    '${OK_NOK}' == 'OK'    Action Return Code Should Be    ${returnCode}
    Run Keyword If    '${OK_NOK}' == 'NOK'    Action Return Code Should Not Equal    ${returnCode}
    Action Return Status Should Be    ${returnStatus}
    [Teardown]    Add Removed File In Repo    ${working_copy}    ${target}

Remove File In Repo
    [Arguments]    ${working_copy}    ${target}    ${removeFile}    ${recursive}
    Init Action    ${ACTION_REMOVE}
    Action Set    ${PRT_REMOVE_CVS_URI}    ${_CVS_URI}
    Action Set    ${PRT_REMOVE_CVS_WORKING_DIRECTORY}    ${working_copy}
    Action Set    ${PRT_REMOVE_CVS_PASSWORD}    ${_CVS_PASS}
    Action Set    ${PRT_REMOVE_CVS_TARGET_PATH}    ${target}
    Action Set    ${PRT_REMOVE_CVS_DELETE_FILE}    ${removeFile}
    Action Set    ${PRT_REMOVE_CVS_RECURSIVE}    ${recursive}
    Action Execute

Add File or folder to repo
    [Arguments]    ${working_copy}    ${target}    ${module}
    Init Action    ${ACTION_ADD}
    Action Set    ${PRT_ADD_CVS_URI}    ${_CVS_URI}
    Action Set    ${PRT_ADD_CVS_PASSWORD}    ${_CVS_PASS}
    Action Set    ${PRT_ADD_CVS_WORKING_DIRECTORY}    ${working_copy}
    Action Set    ${PRT_ADD_CVS_TARGET_PATH}    ${target}
    Action Set    ${PRT_ADD_CVS_MESSAGE}    Add to commit
    Action Set    ${PRT_ADD_CVS_MODULE}    ${module}
    Action Execute

Add Removed File In Repo
    [Arguments]    ${working_copy}    ${target}
    Init Action    ${ACTION_ADD}
    Action Set    ${PRT_ADD_CVS_URI}    ${uri}
    Action Set    ${PRT_ADD_CVS_PASSWORD}    ${password}
    Action Set    ${PRT_ADD_CVS_WORKING_DIRECTORY}    ${working_copy}
    Action Set    ${PRT_ADD_CVS_TARGET_PATH}    ${target}
    Action Set    ${PRT_ADD_CVS_MESSAGE}    re-add file
    Action Set    ${PRT_ADD_CVS_MODULE}    ${EMPTY}
    Action Execute

Create Repository Template
    [Arguments]    ${path}    ${repo_name}    ${failIfExisted}
    Init Action    ${ACTION_CREATE}
    Action Set    ${PRT_CREATE_REPOSITORY_CVS_PATH}    ${path}
    Action Set    ${PRT_CREATE_REPOSITORY_REPO_NAME}    ${repo_name}
    Action Set    ${PRT_CREATE_REPOSITORY_CVS_FAIL_EXISTING}    ${failIfExisted}
    Action Execute

Update Working Dir
    [Arguments]    ${working_copy}
    Init Action    ${ACTION_UPDATE}
    Action Set    ${PRT_UPDATE_CVS_URI}    ${_CVS_URI}
    Action Set    ${PRT_UPDATE_CVS_PASSWORD}    ${_CVS_PASS}
    Action Set    ${PRT_UPDATE_CVS_WORKING_DIRECTORY}    ${working_copy}
    Action Set    ${PRT_UPDATE_CVS_REVISION}    ${EMPTY}
    Action Set    ${PRT_UPDATE_CVS_OVERWRITE}    YES
    Action Execute
