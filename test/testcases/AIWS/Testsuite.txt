*** Settings ***
Default Tags      win
Test Template     AIWS Template
Resource          ../../resources/keywords.txt

*** Test Cases ***    OK_NOK     USERNAME                       PASSWORD                       HOST                           DN NAME                           DSN                           PRODUCT ID         ITEM ID                                    VARIANT      ITEM TYPE      REVISION               WORKSET                FILENAME                  WSFILENAME            CHANGEIDS        RETCODE    STATUS          REPORT MESSAGE
1.Successful action request with valid parameters_ACTION
                      [Setup]    Remove Item Workset
                      OK         ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#1            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_OK}     Operation completed

2.Fail with invalid user
                      NOK        ${_DIMENSIONS_USER}_invalid    ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

3.Fail with invalid password
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}_invalid    ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

4.Fail with invalid host
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}_invalid    ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

5.Fail with invalid database name
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}_invalid    ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

6.Fail with invalid dsn
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}_invalid    QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

7.Fail with invalid Product id
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS_invalid    HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

8.Fail with invalid Item ID
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-189061173X2500X0 invalid    A            SRC            java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

9.Fail with invalid Variant
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A_invalid    SRC            java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

10.Fail with invalid itemType
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC_invalid    java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

11.Fail with invalid revision
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#2_invalid    QLARIUS:ABC            HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

12.Fail with invalid workset
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#2            QLARIUS:ABC_invalid    HuyTQ_test.rtf            New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

13.Fail with invalid filename
                      NOK        ${_DIMENSIONS_USER}            ${_DIMENSIONS_PASS}            ${_DIMENSIONS_HOST}            ${_DIMENSIONS_DB_NAME}            ${_DIMENSIONS_DSN}            QLARIUS            HUYTQ TEST RTF-190795421X6832X0            A            SRC            java_s1_1#2            QLARIUS:ABC            HuyTQ_test.rtf_invalid    New_HuyTQ_test.rtf    QLARIUS_CR_42    0          ${ENDED_NOK}    ${EMPTY}

*** Keywords ***
AIWS Template
    [Arguments]    ${OK_NOK}    ${user}    ${pass}    ${host}    ${dbname}    ${dsn}
    ...    ${productId}    ${itemId}    ${variant}    ${itemType}    ${revision}    ${workset}
    ...    ${filename}    ${wsfilename}    ${changeIds}    ${returnCode}    ${returnStatus}    ${reportMessage}
    [Documentation]    This template used for testing action PCK.AUTOMIC_DIMENSIONS.PUB.ACTION.AIWS with inputs
    ...    - ${user}: Username to access Serena Dimensions CM.
    ...    - ${pass}: Password to access Serena Dimensions CM.
    ...    - ${host}: Serena Dimensions CM hostname
    ...    - ${dbname}: Specifies the Serena Dimensions CM database identifier.
    ...    - ${dsn}: message should be contained in execution report
    ...    - ${productId}: Product Name.
    ...    - ${itemId}: Item ID. May be omitted if 'File name' is defined..
    ...    - ${variant}: Varient. May be omitted if only one exists.
    ...    - ${itemType}: Item Type.
    ...    - ${revision}: Item Revision.
    ...    - ${workset}: Workset
    ...    - ${filename}: Specifies the name of the project file name.
    ...    - ${wsfilename}: The WS_FILENAME qualifier specifies the workset filename for the item when adding the item to a project.
    ...    - ${changeIds}: Comma separated list of request names the add item task will be associated with.
    ...    - ${returnCode}: return code of execution
    ...    - ${returnStatus}: return status of execution
    ...    - ${reportMessage}: message should be contained in execution report
    Init Action    ${ACTION_AIWS}
    Action Set    ${PRT_DIMENSIONS_USERNAME}    ${user}
    Action Set    ${PRT_DIMENSIONS_PASSWORD}    ${pass}
    Action Set    ${PRT_DIMENSIONS_HOST}    ${host}
    Action Set    ${PRT_DIMENSIONS_DBNAME}    ${dbname}
    Action Set    ${PRT_DIMENSIONS_DSN}    ${dsn}
    Action Set    ${PRT_AIWS_DIMENSIONS_PRODUCT_ID}    ${productId}
    Action Set    ${PRT_AIWS_DIMENSIONS_ITEM_ID}    ${itemId}
    Action Set    ${PRT_AIWS_DIMENSIONS_VARIANT}    ${variant}
    Action Set    ${PRT_AIWS_DIMENSIONS_ITEM_TYPE}    ${itemType}
    Action Set    ${PRT_AIWS_DIMENSIONS_REVISION}    ${revision}
    Action Set    ${PRT_AIWS_DIMENSIONS_WORKSET}    ${workset}
    Action Set    ${PRT_AIWS_DIMENSIONS_FILENAME}    ${filename}
    Action Set    ${PRT_AIWS_DIMENSIONS_WSFILENAME}    ${wsFileName}
    Action Set    ${PRT_AIWS_DIMENSIONS_CHANGEIDS}    ${changeIds}
    Action Execute
    Action Report Should Be Found
    Run Keyword If    '${OK_NOK}' == 'OK'    Action Return Code Should Be    ${returnCode}
    Run Keyword If    '${OK_NOK}' == 'NOK'    Action Return Code Should Not Equal    ${returnCode}
    Action Return Status Should Be    ${returnStatus}
    Action Report Should Contain    ${reportMessage}
